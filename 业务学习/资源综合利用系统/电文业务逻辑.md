# 采购进厂质量异议处置反馈流程分析 cm_r2dc04_rcv

这个代码实现了采购进厂质量异议处置反馈的功能，对应电文号为R2DC04。以下是详细流程解释：

## 主要流程

1. **数据接收和初始化**
   - 接收电文数据到各个相关表模型（TQMRE21、TQMRE27、TQMRE28、TYMREPCINFO、TQMRE43）
   - 设置当前时间和电文号作为记录修改标识

2. **数据转换与处理**
   - 从接收数据填充TQMRE43表（异议处理记录表）
   - 根据处理代码（actionCode）转换为系统内部的处置结果代码：
     - 60 → K（扣款）
     - 80 → R（让步接收）
     - 30 → T（退货）
     - 如果结果描述为"原样复检"→ F（复检）
     - 如果结果描述为"仲裁复检"→ Z（仲裁）

3. **根据处理标志进行不同处理**
   - 处理标志为"I"（新增）或"U"（更新）时：
     - 当处置结果为复检(F)或仲裁(Z)时的特殊处理
     - 当处置结果为合格(H)或扣款(K)时的处理
   - 其他情况：将处置结果设为"W"（等待质量审核）

## 处置结果代码含义

- H: 合格
- K: 扣款
- R: 让步接收
- T: 退货
- F: 复检
- Z: 仲裁
- W: 等待质量审核

## 复检/仲裁流程

当处置结果为复检(F)或仲裁(Z)时：

1. 检查样品是否已经质量审核成功，如果已审核则拒绝再次处理
2. 更新相关表中的处置结果和修改信息
3. 代码中的注释部分（已被注释掉）包含了原来可能的创建新的复检委托的逻辑

## 合格/扣款流程

当处置结果为合格(H)或扣款(K)时：

1. 更新检验委托状态
2. 更新TYMREPCINFO和TQMRE21表中的数据

## 错误处理

- 使用异常捕获机制处理可能出现的错误
- 调用统一错误处理函数`f_gcre_err_deal`

这个功能主要是处理采购进厂物料质量异议后的处置反馈，根据不同的处置结果（合格、扣款、让步接收、退货、复检、仲裁等）进行相应的系统记录更新和后续流程触发。
